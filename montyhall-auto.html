<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ìë™ ëª¬í‹°í™€ ì‹œë®¬ë ˆì´ì…˜ (ìµœëŒ€ 10ë°°ì†)</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 600px;
        margin: 20px auto;
        text-align: center;
      }
      .doors {
        display: flex;
        justify-content: space-around;
        margin: 20px 0;
      }
      .door {
        width: 100px;
        height: 150px;
        background: brown;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        border-radius: 10px;
        position: relative;
        transition: background 0.3s;
      }
      .door.opened {
        background: #eee;
        color: black;
      }
      .door .content {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 32px;
      }
      #message {
        font-size: 18px;
        margin-top: 15px;
        min-height: 40px;
      }
      #stats {
        margin-top: 20px;
        font-size: 16px;
      }
      button {
        padding: 10px 15px;
        font-size: 16px;
        margin-top: 10px;
      }
      #controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        align-items: center;
        margin-bottom: 10px;
      }
    </style>
  </head>
  <body>
    <h1>ìë™ ëª¬í‹°í™€ ì‹œë®¬ë ˆì´ì…˜ (ìµœëŒ€ 10ë°°ì†)</h1>
    <p>ë¬¸ì´ ìë™ìœ¼ë¡œ ì—´ë¦¬ê³  ë‹«í™ë‹ˆë‹¤. ë¬¸ ë°”ê¾¸ê¸° ì „ëµìœ¼ë¡œ ì§„í–‰í•©ë‹ˆë‹¤.</p>
    <div id="controls">
      <button id="startBtn">ì‹œì‘í•˜ê¸°</button>
      <button id="stopBtn" style="display: none">ë©ˆì¶”ê¸°</button>
      <label for="speedSelect">ë°°ì†:</label>
      <select id="speedSelect">
        <option value="0.5">0.5x</option>
        <option value="1" selected>1x</option>
        <option value="2">2x</option>
        <option value="3">3x</option>
        <option value="5">5x</option>
        <option value="10">10x</option>
      </select>
    </div>

    <div class="doors">
      <div class="door" id="door0" data-index="0">ë¬¸ 1</div>
      <div class="door" id="door1" data-index="1">ë¬¸ 2</div>
      <div class="door" id="door2" data-index="2">ë¬¸ 3</div>
    </div>
    <div id="message"></div>
    <div id="stats"></div>

    <script>
      const doors = document.querySelectorAll(".door")
      const message = document.getElementById("message")
      const stats = document.getElementById("stats")
      const startBtn = document.getElementById("startBtn")
      const stopBtn = document.getElementById("stopBtn")
      const speedSelect = document.getElementById("speedSelect")

      let carDoor, playerChoice, openedDoor
      let switchWins = 0
      let totalGames = 0
      let intervalId = null
      let speed = 1

      function resetDoors() {
        doors.forEach((d) => {
          d.classList.remove("opened", "chosen")
          d.textContent = `ë¬¸ ${parseInt(d.dataset.index) + 1}`
          d.style.background = "brown"
          d.style.color = "white"
          d.querySelector(".content")?.remove()
        })
      }

      function openDoor(index) {
        const door = doors[index]
        door.classList.add("opened")
        door.style.background = "#eee"
        door.style.color = "black"
        let content = document.createElement("div")
        content.className = "content"
        content.textContent = index === carDoor ? "ğŸš—" : "ğŸ"
        door.appendChild(content)
      }

      function delay(ms) {
        return new Promise((resolve) => setTimeout(resolve, ms / speed))
      }

      async function runGame() {
        resetDoors()
        message.textContent = "ìƒˆ ê²Œì„ ì‹œì‘!"

        carDoor = Math.floor(Math.random() * 3)
        playerChoice = Math.floor(Math.random() * 3)
        doors[playerChoice].classList.add("chosen")

        message.textContent = `í”Œë ˆì´ì–´ê°€ ë¬¸ ${playerChoice + 1}ë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤.`
        await delay(1000)

        const candidates = [0, 1, 2].filter(
          (i) => i !== playerChoice && i !== carDoor,
        )
        openedDoor = candidates[Math.floor(Math.random() * candidates.length)]
        openDoor(openedDoor)
        message.textContent = `ì‚¬íšŒìê°€ ë¬¸ ${openedDoor + 1}ë¥¼ ì—´ì—ˆìŠµë‹ˆë‹¤ (ì—¼ì†Œ!).`
        await delay(1000)

        let switchChoice = [0, 1, 2].filter(
          (i) => i !== playerChoice && i !== openedDoor,
        )[0]
        doors[playerChoice].classList.remove("chosen")
        playerChoice = switchChoice
        doors[playerChoice].classList.add("chosen")
        message.textContent = `í”Œë ˆì´ì–´ê°€ ë¬¸ì„ ë°”ê¿” ë¬¸ ${playerChoice + 1}ë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤.`
        await delay(1000)

        ;[0, 1, 2].forEach((i) => {
          if (!doors[i].classList.contains("opened")) openDoor(i)
        })

        totalGames++
        if (playerChoice === carDoor) {
          switchWins++
          message.textContent = `ì¶•í•˜í•©ë‹ˆë‹¤! ìë™ì°¨ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤!`
        } else {
          message.textContent = `ì•„ì‰½ì§€ë§Œ ì—¼ì†Œì˜€ìŠµë‹ˆë‹¤.`
        }

        stats.innerHTML = `
      <p>ì´ ê²Œì„ íšŸìˆ˜: ${totalGames}</p>
      <p>ë¬¸ ë°”ê¾¸ê¸° ì „ëµ ìŠ¹ë¦¬ íšŸìˆ˜: ${switchWins} (${((switchWins / totalGames) * 100).toFixed(2)}%)</p>
      <p>ë¬¸ ë°”ê¾¸ê¸° ì „ëµ ì‹¤íŒ¨ íšŸìˆ˜: ${totalGames - switchWins} (${(((totalGames - switchWins) / totalGames) * 100).toFixed(2)}%)</p>
    `
        await delay(1500)
      }

      function startAuto() {
        if (intervalId) return
        speed = parseFloat(speedSelect.value)
        startBtn.style.display = "none"
        stopBtn.style.display = "inline-block"
        intervalId = setInterval(runGame, 4500 / speed)
      }

      function stopAuto() {
        clearInterval(intervalId)
        intervalId = null
        startBtn.style.display = "inline-block"
        stopBtn.style.display = "none"
        message.textContent = "ìë™ ì‹œë®¬ë ˆì´ì…˜ì´ ë©ˆì·„ìŠµë‹ˆë‹¤."
      }

      startBtn.addEventListener("click", startAuto)
      stopBtn.addEventListener("click", stopAuto)
      speedSelect.addEventListener("change", () => {
        if (intervalId) {
          stopAuto()
          startAuto()
        }
      })
    </script>
  </body>
</html>
